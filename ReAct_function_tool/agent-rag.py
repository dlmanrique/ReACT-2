import os
import json
import pandas as pd
from termcolor import colored
from openai import AzureOpenAI
from retriever import Retriever
from tenacity import retry, wait_random_exponential, stop_after_attempt

############################### Few-shot conversation history ###############################
conversation_history_few_shot = [
    # example 1
    {"role": "user", "content": "¿Qué procedimientos debo seguir en caso de emergencia en el lugar de trabajo y cuáles son las medidas de seguridad implementadas?"},
    {"role": "assistant", "content": None, "function_call": None, "tool_calls": [
        {"id": "call_9", "function": {"arguments": "{\"query\":\"¿Qué procedimientos debo seguir en caso de emergencia en el lugar de trabajo?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_10", "function": {"arguments": "{\"query\":\"¿Cuáles son las medidas de seguridad implementadas en el lugar de trabajo?\"}", "name": "doc_retrievalaugmented"}, "type": "function"}
    ]},
    {"tool_call_id": "call_9", "role": "tool", "name": "doc_retrievalaugmented", "content": "Procedimientos de emergencia en el lugar de trabajo\n# Procedimientos de Emergencia\nEn caso de emergencia en el lugar de trabajo, sigue estos pasos:\n1. Mantén la calma y evalúa la situación para determinar la naturaleza de la emergencia.\n2. Activa la alarma de emergencia más cercana para alertar a los demás empleados.\n3. Sigue las instrucciones del personal de seguridad y los líderes de evacuación.\n4. Utiliza las rutas de evacuación designadas y evita el uso de ascensores.\n5. Dirígete al punto de reunión asignado y espera instrucciones adicionales.\n6. Si es seguro hacerlo, asiste a cualquier compañero de trabajo que necesite ayuda.\n7. No reingreses al edificio hasta que las autoridades lo indiquen.\n\n\n####################################################################################################\n\n\nProcedimientos de emergencia en el lugar de trabajo\n# Procedimientos de Emergencia: Incendios\nEn caso de incendio en el lugar de trabajo, sigue estos pasos específicos:\n1. Si detectas un incendio, activa la alarma de incendio inmediatamente.\n2. Usa un extintor de incendios si el fuego es pequeño y sabes cómo utilizarlo de manera segura.\n3. Si el fuego es grande o se propaga rápidamente, evacúa el edificio siguiendo las rutas de evacuación designadas.\n4. Cierra las puertas al salir para contener el fuego, si es seguro hacerlo.\n5. Dirígete al punto de reunión y notifica al personal de seguridad.\n6. No reingreses al edificio hasta que las autoridades lo indiquen.\n\n\n####################################################################################################\n\n\nProcedimientos de emergencia en el lugar de trabajo\n# Procedimientos de Emergencia: Terremotos\nEn caso de terremoto en el lugar de trabajo, sigue estos pasos específicos:\n1. Durante el terremoto, busca refugio bajo un mueble resistente o protégete en una esquina interior.\n2. Aléjate de ventanas, espejos y objetos que puedan caerse.\n3. Mantén la calma y espera a que el temblor termine antes de evacuar.\n4. Una vez que el temblor haya terminado, sigue las instrucciones del personal de seguridad y evacúa el edificio si es necesario.\n5. Utiliza las rutas de evacuación designadas y dirígete al punto de reunión.\n6. Espera instrucciones adicionales de las autoridades.\n\n\n####################################################################################################\n\n\nProcedimientos de emergencia en el lugar de trabajo\n# Procedimientos de Emergencia: Evacuación\nEn caso de que se ordene una evacuación del lugar de trabajo, sigue estos pasos específicos:\n1. Deja todo lo que estés haciendo y procede a evacuar de inmediato.\n2. Sigue las rutas de evacuación designadas y no utilices ascensores.\n3. Asiste a compañeros de trabajo que puedan necesitar ayuda para evacuar.\n4. Dirígete al punto de reunión designado y espera instrucciones adicionales del personal de seguridad.\n5. No reingreses al edificio hasta que las autoridades lo indiquen.\n\n\n####################################################################################################\n\n\nProcedimientos de emergencia en el lugar de trabajo\n# Procedimientos de Emergencia: Amenazas\nEn caso de recibir una amenaza (por ejemplo, una amenaza de bomba) en el lugar de trabajo, sigue estos pasos específicos:\n1. Notifica inmediatamente al personal de seguridad y a las autoridades.\n2. No toques ni muevas ningún objeto sospechoso.\n3. Sigue las instrucciones de las autoridades y del personal de seguridad.\n4. Evacúa el edificio si se te indica hacerlo, siguiendo las rutas de evacuación designadas.\n5. Dirígete al punto de reunión y espera más instrucciones.\n6. No reingreses al edificio hasta que las autoridades lo indiquen."},
    {"tool_call_id": "call_10", "role": "tool", "name": "doc_retrievalaugmented", "content": "Medidas de seguridad implementadas en el lugar de trabajo\n# Medidas de Seguridad\nNuestra empresa ha implementado las siguientes medidas de seguridad en el lugar de trabajo:\n1. Sistemas de alarma de emergencia y detectores de humo en todas las áreas.\n2. Extintores de incendios ubicados estratégicamente y accesibles en todo el edificio.\n3. Rutas de evacuación claramente señalizadas y planos de evacuación disponibles en cada piso.\n4. Personal de seguridad capacitado y presente en todo momento.\n5. Simulacros de emergencia realizados periódicamente para preparar a los empleados.\n6. Botiquines de primeros auxilios disponibles en ubicaciones clave.\n7. Procedimientos de seguridad documentados y accesibles para todos los empleados.\n\n\n####################################################################################################\n\n\nMedidas de seguridad implementadas en el lugar de trabajo\n# Sistemas de Seguridad\nHemos instalado sistemas de seguridad avanzados para garantizar la protección de todos los empleados:\n1. Cámaras de vigilancia en áreas comunes y de alto riesgo.\n2. Controles de acceso electrónicos para limitar el ingreso a áreas restringidas.\n3. Iluminación de emergencia en caso de fallos eléctricos.\n4. Sensores de movimiento en áreas críticas.\n5. Sistemas de comunicación de emergencia para informar rápidamente a todos los empleados en caso de una situación de emergencia.\n\n\n####################################################################################################\n\n\nMedidas de seguridad implementadas en el lugar de trabajo\n# Planes de Emergencia\nNuestra empresa ha desarrollado planes de emergencia detallados que incluyen:\n1. Protocolos de evacuación para diferentes tipos de emergencias (incendios, terremotos, amenazas, etc.).\n2. Identificación de puntos de reunión seguros fuera del edificio.\n3. Listas de verificación de seguridad para los líderes de evacuación.\n4. Procedimientos específicos para asistir a personas con discapacidades durante una emergencia.\n5. Comunicación continua con las autoridades locales para coordinar respuestas a emergencias.\n\n\n####################################################################################################\n\n\nMedidas de seguridad implementadas en el lugar de trabajo\n# Capacitación en Seguridad\nOfrecemos programas de capacitación en seguridad para todos los empleados:\n1. Cursos de primeros auxilios y RCP (resucitación cardiopulmonar).\n2. Entrenamiento en el uso de extintores de incendios y otros equipos de emergencia.\n3. Simulacros de evacuación regulares para practicar los procedimientos de emergencia.\n4. Sesiones informativas sobre la identificación y manejo de amenazas.\n\n\n####################################################################################################\n\n\nMedidas de seguridad implementadas en el lugar de trabajo\n# Revisión y Actualización\nLas medidas de seguridad son revisadas y actualizadas periódicamente:\n1. Auditorías de seguridad internas para identificar y corregir posibles fallas.\n2. Revisión de los procedimientos de emergencia basados en los resultados de simulacros y eventos reales.\n3. Actualización de equipos de seguridad y tecnología para mantener estándares altos de protección.\n4. Retroalimentación de los empleados para mejorar continuamente los protocolos de seguridad."},
    {"role": "assistant", "content": "Aquí tienes los procedimientos a seguir en caso de emergencia en el lugar de trabajo y las medidas de seguridad implementadas:\n\n### Procedimientos de Emergencia\n1. Mantén la calma y evalúa la situación para determinar la naturaleza de la emergencia.\n2. Activa la alarma de emergencia más cercana para alertar a los demás empleados.\n3. Sigue las instrucciones del personal de seguridad y los líderes de evacuación.\n4. Utiliza las rutas de evacuación designadas y evita el uso de ascensores.\n5. Dirígete al punto de reunión asignado y espera instrucciones adicionales.\n6. Si es seguro hacerlo, asiste a cualquier compañero de trabajo que necesite ayuda.\n7. No reingreses al edificio hasta que las autoridades lo indiquen.\n\n\n####################################################################################################\n\n\n2. En caso de incendio, activa la alarma de incendio inmediatamente. Usa un extintor si el fuego es pequeño y sabes cómo utilizarlo de manera segura. Evacúa el edificio si el fuego es grande.\n\n\n####################################################################################################\n\n\n3. En caso de terremoto, busca refugio bajo un mueble resistente o protégete en una esquina interior. Aléjate de ventanas y objetos que puedan caerse. Evacúa el edificio una vez que el temblor haya terminado.\n\n\n####################################################################################################\n\n\n4. Si se ordena una evacuación, deja todo y procede a evacuar de inmediato. Asiste a compañeros que necesiten ayuda y dirígete al punto de reunión designado.\n\n\n####################################################################################################\n\n\n5. En caso de recibir una amenaza, notifica al personal de seguridad y a las autoridades, no toques objetos sospechosos y sigue las instrucciones de evacuación si es necesario.\n\n\n### Medidas de Seguridad Implementadas\n1. Sistemas de alarma de emergencia y detectores de humo en todas las áreas.\n2. Extintores de incendios ubicados estratégicamente y accesibles en todo el edificio.\n3. Rutas de evacuación claramente señalizadas y planos de evacuación disponibles en cada piso.\n4. Personal de seguridad capacitado y presente en todo momento.\n5. Simulacros de emergencia realizados periódicamente para preparar a los empleados.\n6. Botiquines de primeros auxilios disponibles en ubicaciones clave.\n7. Procedimientos de seguridad documentados y accesibles para todos los empleados.\n\n\n####################################################################################################\n\n\n8. Cámaras de vigilancia en áreas comunes y de alto riesgo.\n9. Controles de acceso electrónicos para limitar el ingreso a áreas restringidas.\n10. Iluminación de emergencia en caso de fallos eléctricos.\n11. Sensores de movimiento en áreas críticas.\n12. Sistemas de comunicación de emergencia.\n\n\n####################################################################################################\n\n\n13. Protocolos de evacuación para diferentes tipos de emergencias.\n14. Identificación de puntos de reunión seguros fuera del edificio.\n15. Listas de verificación de seguridad para los líderes de evacuación.\n16. Procedimientos específicos para asistir a personas con discapacidades.\n17. Comunicación continua con las autoridades locales.\n\n\n####################################################################################################\n\n\n18. Cursos de primeros auxilios y RCP.\n19. Entrenamiento en el uso de extintores de incendios.\n20. Simulacros de evacuación regulares.\n21. Sesiones informativas sobre la identificación y manejo de amenazas.\n\n\n####################################################################################################\n\n\n22. Auditorías de seguridad internas.\n23. Revisión de los procedimientos de emergencia.\n24. Actualización de equipos de seguridad y tecnología.\n25. Retroalimentación de los empleados para mejorar los protocolos de seguridad."},
    # example 2
    {"role": "user", "content": "¿Qué beneficios están disponibles para los empleados en términos de desarrollo profesional y cómo puedo acceder a ellos?"},
    {"role": "assistant", "content": None, "function_call": None, "tool_calls": [
        {"id": "call_11", "function": {"arguments": "{\"query\":\"¿Qué beneficios están disponibles para los empleados en términos de desarrollo profesional?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_12", "function": {"arguments": "{\"query\":\"¿Cómo puedo acceder a los beneficios de desarrollo profesional?\"}", "name": "doc_retrievalaugmented"}, "type": "function"}
    ]},
    {"tool_call_id": "call_11", "role": "tool", "name": "doc_retrievalaugmented", "content": "Beneficios de desarrollo profesional para empleados\n# Beneficios de Desarrollo Profesional\nNuestra empresa ofrece los siguientes beneficios de desarrollo profesional para los empleados:\n1. Programas de capacitación y desarrollo continuo en diversas áreas.\n2. Acceso a cursos en línea y presenciales cubiertos por la empresa.\n3. Oportunidades de mentoría y coaching con líderes experimentados.\n4. Programas de rotación laboral para adquirir experiencia en diferentes departamentos.\n5. Planes de carrera personalizados para apoyar el crecimiento profesional.\n6. Participación en conferencias y seminarios profesionales.\n\n\n####################################################################################################\n\n\nBeneficios de desarrollo profesional para empleados\n# Capacitación y Desarrollo\n1. Ofrecemos una amplia gama de cursos y talleres en habilidades técnicas y blandas.\n2. Los empleados pueden inscribirse en programas de certificación profesional.\n3. Disponemos de una biblioteca de recursos de aprendizaje en línea.\n4. Apoyo financiero para estudios superiores y posgrados relacionados con el trabajo.\n5. Programas de liderazgo para identificar y desarrollar futuros líderes dentro de la organización.\n\n\n####################################################################################################\n\n\nBeneficios de desarrollo profesional para empleados\n# Oportunidades de Mentoría y Coaching\n1. Los empleados tienen acceso a mentoría individual con líderes de la empresa.\n2. Programas de coaching grupal para equipos y departamentos.\n3. Evaluaciones de desempeño para identificar áreas de mejora y establecer objetivos de desarrollo.\n4. Redes de apoyo profesional dentro de la empresa para fomentar el intercambio de conocimientos.\n5. Talleres de desarrollo de habilidades de liderazgo y gestión.\n\n\n####################################################################################################\n\n\nBeneficios de desarrollo profesional para empleados\n# Planes de Carrera\n1. Planificación de carrera personalizada para alinear los objetivos profesionales con las oportunidades dentro de la empresa.\n2. Evaluaciones de talento para identificar fortalezas y áreas de desarrollo.\n3. Programas de sucesión para preparar a los empleados para roles de mayor responsabilidad.\n4. Sesiones de orientación profesional con expertos internos y externos.\n5. Herramientas y recursos para la autoevaluación y el desarrollo personal.\n\n\n####################################################################################################\n\n\nBeneficios de desarrollo profesional para empleados\n# Conferencias y Seminarios\n1. Los empleados pueden asistir a conferencias y seminarios relevantes para su área de trabajo.\n2. La empresa cubre los costos de inscripción y viaje para eventos aprobados.\n3. Oportunidades para presentar trabajos e investigaciones en conferencias profesionales.\n4. Acceso a una red de contactos profesionales a través de eventos y conferencias.\n5. Informes y resúmenes de conferencias disponibles para todos los empleados."},
    {"tool_call_id": "call_12", "role": "tool", "name": "doc_retrievalaugmented", "content": "Acceso a beneficios de desarrollo profesional\n# Cómo acceder a los beneficios\nPara acceder a los beneficios de desarrollo profesional, sigue estos pasos:\n1. Visita el portal del empleado y navega hasta la sección de Desarrollo Profesional.\n2. Revisa los programas y cursos disponibles y selecciona los que te interesen.\n3. Completa el formulario de inscripción en línea para cada programa o curso.\n4. Consulta con tu supervisor para obtener aprobación y asegurar que el curso o programa esté alineado con tus objetivos profesionales.\n5. Una vez aprobado, recibirás confirmación por correo electrónico con los detalles del curso o programa.\n\n\n####################################################################################################\n\n\nAcceso a beneficios de desarrollo profesional\n# Pasos para la Inscripción\n1. Inicia sesión en el portal del empleado con tus credenciales.\n2. Dirígete a la sección de Capacitación y Desarrollo.\n3. Selecciona el curso o programa de interés y haz clic en 'Inscribirse'.\n4. Completa los detalles requeridos y envía tu solicitud.\n5. Espera la aprobación de tu supervisor y del departamento de recursos humanos.\n6. Recibirás una notificación de confirmación una vez que tu inscripción haya sido procesada.\n\n\n####################################################################################################\n\n\nAcceso a beneficios de desarrollo profesional\n# Asesoramiento y Apoyo\n1. Si necesitas ayuda para elegir un curso o programa, contacta al departamento de Desarrollo Profesional.\n2. Asesores de carrera están disponibles para ayudarte a planificar tu desarrollo profesional.\n3. Sesiones informativas periódicas sobre nuevos programas y oportunidades de desarrollo.\n4. Recursos en línea y guías de autoayuda para maximizar el uso de los beneficios disponibles.\n5. Encuestas de satisfacción y retroalimentación para mejorar continuamente los programas ofrecidos.\n\n\n####################################################################################################\n\n\nAcceso a beneficios de desarrollo profesional\n# Programas de Mentoría\n1. Solicita un mentor a través del portal del empleado en la sección de Mentoría.\n2. Completa un perfil detallado para emparejarte con un mentor adecuado.\n3. Participa en sesiones de mentoría regulares y sigue las recomendaciones de tu mentor.\n4. Utiliza las herramientas y recursos proporcionados por el programa de mentoría.\n5. Evalúa tu progreso y ajusta tus objetivos en colaboración con tu mentor.\n\n\n####################################################################################################\n\n\nAcceso a beneficios de desarrollo profesional\n# Recursos Adicionales\n1. Acceso a la biblioteca de recursos de aprendizaje en línea a través del portal del empleado.\n2. Inscripción en boletines informativos sobre oportunidades de desarrollo profesional.\n3. Participación en foros y grupos de discusión internos para compartir conocimientos.\n4. Contacta a desarrollo_profesional@empresa.com para cualquier duda o asistencia adicional.\n5. Mantente informado sobre nuevas oportunidades a través de anuncios en el portal del empleado."},
    {"role": "assistant", "content": "Nuestra empresa ofrece varios beneficios para el desarrollo profesional y aquí tienes la información sobre cómo acceder a ellos:\n\n### Beneficios de Desarrollo Profesional\n1. Programas de capacitación y desarrollo continuo en diversas áreas.\n2. Acceso a cursos en línea y presenciales cubiertos por la empresa.\n3. Oportunidades de mentoría y coaching con líderes experimentados.\n4. Programas de rotación laboral para adquirir experiencia en diferentes departamentos.\n5. Planes de carrera personalizados para apoyar el crecimiento profesional.\n6. Participación en conferencias y seminarios profesionales.\n\n\n####################################################################################################\n\n\n7. Una amplia gama de cursos y talleres en habilidades técnicas y blandas.\n8. Inscripción en programas de certificación profesional.\n9. Biblioteca de recursos de aprendizaje en línea.\n10. Apoyo financiero para estudios superiores y posgrados relacionados con el trabajo.\n11. Programas de liderazgo para identificar y desarrollar futuros líderes.\n\n\n####################################################################################################\n\n\n12. Acceso a mentoría individual con líderes de la empresa.\n13. Programas de coaching grupal para equipos y departamentos.\n14. Evaluaciones de desempeño para identificar áreas de mejora.\n15. Redes de apoyo profesional dentro de la empresa.\n16. Talleres de desarrollo de habilidades de liderazgo y gestión.\n\n\n####################################################################################################\n\n\n17. Planificación de carrera personalizada para alinear los objetivos profesionales con las oportunidades dentro de la empresa.\n18. Evaluaciones de talento para identificar fortalezas y áreas de desarrollo.\n19. Programas de sucesión para preparar a los empleados para roles de mayor responsabilidad.\n20. Sesiones de orientación profesional con expertos internos y externos.\n21. Herramientas y recursos para la autoevaluación y el desarrollo personal.\n\n\n####################################################################################################\n\n\n22. Asistencia a conferencias y seminarios relevantes para su área de trabajo.\n23. La empresa cubre los costos de inscripción y viaje para eventos aprobados.\n24. Oportunidades para presentar trabajos e investigaciones en conferencias profesionales.\n25. Acceso a una red de contactos profesionales a través de eventos y conferencias.\n26. Informes y resúmenes de conferencias disponibles para todos los empleados.\n\n\n### Cómo Acceder a los Beneficios de Desarrollo Profesional\n1. Visita el portal del empleado y navega hasta la sección de Desarrollo Profesional.\n2. Revisa los programas y cursos disponibles y selecciona los que te interesen.\n3. Completa el formulario de inscripción en línea para cada programa o curso.\n4. Consulta con tu supervisor para obtener aprobación y asegurar que el curso o programa esté alineado con tus objetivos profesionales.\n5. Una vez aprobado, recibirás confirmación por correo electrónico con los detalles del curso o programa.\n\n\n####################################################################################################\n\n\n6. Inicia sesión en el portal del empleado con tus credenciales.\n7. Dirígete a la sección de Capacitación y Desarrollo.\n8. Selecciona el curso o programa de interés y haz clic en 'Inscribirse'.\n9. Completa los detalles requeridos y envía tu solicitud.\n10. Espera la aprobación de tu supervisor y del departamento de recursos humanos.\n11. Recibirás una notificación de confirmación una vez que tu inscripción haya sido procesada.\n\n\n####################################################################################################\n\n\n12. Si necesitas ayuda para elegir un curso o programa, contacta al departamento de Desarrollo Profesional.\n13. Asesores de carrera están disponibles para ayudarte a planificar tu desarrollo profesional.\n14. Sesiones informativas periódicas sobre nuevos programas y oportunidades de desarrollo.\n15. Recursos en línea y guías de autoayuda para maximizar el uso de los beneficios disponibles.\n16. Encuestas de satisfacción y retroalimentación para mejorar continuamente los programas ofrecidos.\n\n\n####################################################################################################\n\n\n17. Solicita un mentor a través del portal del empleado en la sección de Mentoría.\n18. Completa un perfil detallado para emparejarte con un mentor adecuado.\n19. Participa en sesiones de mentoría regulares y sigue las recomendaciones de tu mentor.\n20. Utiliza las herramientas y recursos proporcionados por el programa de mentoría.\n21. Evalúa tu progreso y ajusta tus objetivos en colaboración con tu mentor.\n\n\n####################################################################################################\n\n\n22. Acceso a la biblioteca de recursos de aprendizaje en línea a través del portal del empleado.\n23. Inscripción en boletines informativos sobre oportunidades de desarrollo profesional.\n24. Participación en foros y grupos de discusión internos para compartir conocimientos.\n25. Contacta a desarrollo_profesional@empresa.com para cualquier duda o asistencia adicional.\n26. Mantente informado sobre nuevas oportunidades a través de anuncios en el portal del empleado."},
    # example 3
    {"role": "user", "content": "¿Qué procedimientos debo seguir para reportar un incidente de seguridad informática y cuáles son las políticas de la empresa sobre este tema?"},
    {"role": "assistant", "content": None, "function_call": None, "tool_calls": [
        {"id": "call_15", "function": {"arguments": "{\"query\":\"¿Qué procedimientos debo seguir para reportar un incidente de seguridad informática?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_16", "function": {"arguments": "{\"query\":\"¿Cuáles son las políticas de la empresa sobre seguridad informática?\"}", "name": "doc_retrievalaugmented"}, "type": "function"}
    ]},
    {"tool_call_id": "call_15", "role": "tool", "name": "doc_retrievalaugmented", "content": "Procedimientos para reportar incidentes de seguridad informática\n# Reportar Incidentes de Seguridad\nPara reportar un incidente de seguridad informática, sigue estos pasos:\n1. Identifica y documenta el incidente con la mayor cantidad de detalles posibles.\n2. Notifica inmediatamente al departamento de TI a través del sistema de tickets o por correo electrónico a seguridad@empresa.com.\n3. Proporciona toda la información relevante, incluyendo capturas de pantalla, descripciones de errores y cualquier mensaje de alerta recibido.\n4. Evita intentar solucionar el problema por tu cuenta para no comprometer la evidencia.\n5. Sigue las instrucciones del personal de seguridad informática para contener y resolver el incidente.\n6. Participa en la revisión posterior al incidente para identificar mejoras y prevenir futuros problemas.\n\n\n####################################################################################################\n\n\nProcedimientos para reportar incidentes de seguridad informática\n# Detalles a Incluir en el Reporte\n1. Fecha y hora del incidente.\n2. Descripción detallada del incidente y sus efectos.\n3. Dispositivos y sistemas afectados.\n4. Medidas temporales tomadas para contener el incidente.\n5. Información de contacto del reportante.\n\n\n####################################################################################################\n\n\nProcedimientos para reportar incidentes de seguridad informática\n# Comunicación y Coordinación\n1. Mantén una comunicación constante con el equipo de seguridad informática durante la resolución del incidente.\n2. Colabora con otros departamentos si el incidente afecta múltiples áreas.\n3. Informa a tu supervisor sobre el incidente y las medidas tomadas.\n4. Actualiza el reporte de incidente con nuevos desarrollos o información adicional.\n5. Participa en reuniones de seguimiento para evaluar el impacto del incidente y las acciones correctivas.\n\n\n####################################################################################################\n\n\nProcedimientos para reportar incidentes de seguridad informática\n# Seguimiento y Evaluación\n1. Registra el incidente en el sistema de gestión de incidentes de la empresa.\n2. Realiza un análisis post-mortem para identificar la causa raíz del incidente.\n3. Implementa las recomendaciones y medidas preventivas sugeridas por el equipo de seguridad informática.\n4. Actualiza las políticas y procedimientos de seguridad si es necesario.\n5. Capacita a los empleados sobre las mejores prácticas de seguridad para evitar futuros incidentes.\n\n\n####################################################################################################\n\n\nProcedimientos para reportar incidentes de seguridad informática\n# Ejemplos de Incidentes a Reportar\n1. Accesos no autorizados a sistemas o datos.\n2. Malware, virus o ransomware detectado en dispositivos de la empresa.\n3. Pérdida o robo de dispositivos que contienen datos sensibles.\n4. Fallos en la seguridad de la red o en la infraestructura de TI.\n5. Actividades sospechosas o inusuales en cuentas de usuario."},
    {"tool_call_id": "call_16", "role": "tool", "name": "doc_retrievalaugmented", "content": "Políticas de seguridad informática de la empresa\n# Políticas de Seguridad Informática\nNuestra empresa cuenta con las siguientes políticas de seguridad informática:\n1. Uso obligatorio de contraseñas seguras y autenticación multifactor para acceder a sistemas sensibles.\n2. Actualización regular de software y sistemas operativos para proteger contra vulnerabilidades conocidas.\n3. Monitoreo continuo de la red y sistemas para detectar actividades sospechosas.\n4. Prohibición del uso de dispositivos y software no autorizados en la red corporativa.\n5. Capacitación periódica en seguridad informática para todos los empleados.\n\n\n####################################################################################################\n\n\nPolíticas de seguridad informática de la empresa\n# Protección de Datos\n1. Encriptación de datos sensibles tanto en tránsito como en reposo.\n2. Políticas estrictas de acceso basado en roles para limitar el acceso a información confidencial.\n3. Copias de seguridad regulares y almacenamiento seguro de los datos de la empresa.\n4. Eliminación segura de datos y dispositivos obsoletos para prevenir la recuperación no autorizada de información.\n\n\n####################################################################################################\n\n\nPolíticas de seguridad informática de la empresa\n# Respuesta a Incidentes\n1. Establecimiento de un equipo de respuesta a incidentes de seguridad (CSIRT).\n2. Procedimientos claros para la notificación, gestión y resolución de incidentes de seguridad.\n3. Comunicación inmediata de incidentes graves a la alta dirección y a las autoridades pertinentes si es necesario.\n4. Documentación y análisis de todos los incidentes para mejorar las medidas de seguridad.\n\n\n####################################################################################################\n\n\nPolíticas de seguridad informática de la empresa\n# Uso Aceptable de Recursos\n1. Uso responsable de los recursos informáticos de la empresa, incluyendo el correo electrónico y el acceso a Internet.\n2. Prohibición de actividades ilegales o no éticas utilizando los sistemas de la empresa.\n3. Revisión y aceptación de la política de uso aceptable por parte de todos los empleados.\n\n\n####################################################################################################\n\n\nPolíticas de seguridad informática de la empresa\n# Auditorías y Cumplimiento\n1. Auditorías regulares de seguridad para asegurar el cumplimiento de las políticas y procedimientos.\n2. Evaluaciones de riesgo periódicas para identificar y mitigar nuevas amenazas.\n3. Implementación de controles internos para asegurar la adherencia a las políticas de seguridad.\n4. Reporte de hallazgos de auditoría a la alta dirección y seguimiento de las acciones correctivas."},
    {"role": "assistant", "content": "Para reportar un incidente de seguridad informática y conocer las políticas de la empresa sobre este tema, sigue estos pasos y ten en cuenta las siguientes políticas:\n\n### Procedimientos para Reportar Incidentes de Seguridad Informática\n1. Identifica y documenta el incidente con la mayor cantidad de detalles posibles.\n2. Notifica inmediatamente al departamento de TI a través del sistema de tickets o por correo electrónico a seguridad@empresa.com.\n3. Proporciona toda la información relevante, incluyendo capturas de pantalla, descripciones de errores y cualquier mensaje de alerta recibido.\n4. Evita intentar solucionar el problema por tu cuenta para no comprometer la evidencia.\n5. Sigue las instrucciones del personal de seguridad informática para contener y resolver el incidente.\n6. Participa en la revisión posterior al incidente para identificar mejoras y prevenir futuros problemas.\n\n\n####################################################################################################\n\n\n7. Incluye detalles como fecha y hora del incidente, descripción detallada del incidente y sus efectos, dispositivos y sistemas afectados, medidas temporales tomadas, e información de contacto del reportante.\n8. Mantén una comunicación constante con el equipo de seguridad informática durante la resolución del incidente y colabora con otros departamentos si es necesario.\n9. Informa a tu supervisor sobre el incidente y las medidas tomadas, y actualiza el reporte de incidente con nuevos desarrollos.\n10. Registra el incidente en el sistema de gestión de incidentes, realiza un análisis post-mortem, implementa recomendaciones y actualiza políticas de seguridad.\n11. Capacita a los empleados sobre las mejores prácticas de seguridad para evitar futuros incidentes.\n\n\n####################################################################################################\n\n\n12. Ejemplos de incidentes a reportar incluyen accesos no autorizados, malware, pérdida o robo de dispositivos, fallos en la seguridad de la red, y actividades sospechosas en cuentas de usuario.\n\n\n### Políticas de Seguridad Informática de la Empresa\n1. Uso obligatorio de contraseñas seguras y autenticación multifactor para acceder a sistemas sensibles.\n2. Actualización regular de software y sistemas operativos para proteger contra vulnerabilidades conocidas.\n3. Monitoreo continuo de la red y sistemas para detectar actividades sospechosas.\n4. Prohibición del uso de dispositivos y software no autorizados en la red corporativa.\n5. Capacitación periódica en seguridad informática para todos los empleados.\n\n\n####################################################################################################\n\n\n6. Encriptación de datos sensibles tanto en tránsito como en reposo.\n7. Políticas estrictas de acceso basado en roles para limitar el acceso a información confidencial.\n8. Copias de seguridad regulares y almacenamiento seguro de los datos de la empresa.\n9. Eliminación segura de datos y dispositivos obsoletos para prevenir la recuperación no autorizada de información.\n\n\n####################################################################################################\n\n\n10. Establecimiento de un equipo de respuesta a incidentes de seguridad (CSIRT).\n11. Procedimientos claros para la notificación, gestión y resolución de incidentes de seguridad.\n12. Comunicación inmediata de incidentes graves a la alta dirección y a las autoridades pertinentes si es necesario.\n13. Documentación y análisis de todos los incidentes para mejorar las medidas de seguridad.\n\n\n####################################################################################################\n\n\n14. Uso responsable de los recursos informáticos de la empresa, incluyendo el correo electrónico y el acceso a Internet.\n15. Prohibición de actividades ilegales o no éticas utilizando los sistemas de la empresa.\n16. Revisión y aceptación de la política de uso aceptable por parte de todos los empleados.\n\n\n####################################################################################################\n\n\n17. Auditorías regulares de seguridad para asegurar el cumplimiento de las políticas y procedimientos.\n18. Evaluaciones de riesgo periódicas para identificar y mitigar nuevas amenazas.\n19. Implementación de controles internos para asegurar la adherencia a las políticas de seguridad.\n20. Reporte de hallazgos de auditoría a la alta dirección y seguimiento de las acciones correctivas."},
    # example 4
    {"role": "user", "content": "¿Cuáles son las políticas de la empresa sobre licencias de maternidad y paternidad y cómo puedo solicitarlas?"},
    {"role": "assistant", "content": None, "function_call": None, "tool_calls": [
        {"id": "call_17", "function": {"arguments": "{\"query\":\"¿Cuáles son las políticas de la empresa sobre licencias de maternidad?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_18", "function": {"arguments": "{\"query\":\"¿Cuáles son las políticas de la empresa sobre licencias de paternidad?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_19", "function": {"arguments": "{\"query\":\"¿Cómo puedo solicitar la licencia de maternidad?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_20", "function": {"arguments": "{\"query\":\"¿Cómo puedo solicitar la licencia de paternidad?\"}", "name": "doc_retrievalaugmented"}, "type": "function"}
    ]},
    {"tool_call_id": "call_17", "role": "tool", "name": "doc_retrievalaugmented", "content": "Políticas sobre licencias de maternidad\n# Licencias de Maternidad\nNuestra empresa ofrece las siguientes políticas sobre licencias de maternidad:\n1. Las empleadas tienen derecho a una licencia de maternidad de 18 semanas pagadas.\n2. La licencia puede comenzar dos semanas antes de la fecha prevista del parto.\n3. Durante la licencia, la empleada recibirá su salario completo.\n4. La empleada debe presentar un certificado médico confirmando la fecha de parto prevista.\n5. En caso de complicaciones médicas, la licencia puede extenderse según las recomendaciones del médico.\n\n\n####################################################################################################\n\n\nPolíticas sobre licencias de maternidad\n# Beneficios Durante la Licencia de Maternidad\n1. Continuidad de todos los beneficios laborales, incluidos seguro médico y acumulación de vacaciones.\n2. Protección del puesto de trabajo, garantizando el regreso a la misma posición o a una similar al finalizar la licencia.\n3. Asesoramiento y apoyo durante el período de licencia a través del departamento de recursos humanos.\n4. Posibilidad de ajustar horarios y modalidades de trabajo al regresar de la licencia, de acuerdo a las necesidades de la empleada.\n5. Acceso a programas de apoyo para nuevas madres, incluyendo grupos de apoyo y recursos educativos.\n\n\n####################################################################################################\n\n\nPolíticas sobre licencias de maternidad\n# Extensiones y Consideraciones Especiales\n1. En casos de nacimiento prematuro, la licencia de maternidad se ajustará para asegurar el tiempo de recuperación necesario.\n2. Si la empleada requiere más tiempo debido a complicaciones, deberá presentar un certificado médico adicional.\n3. La empresa permite el uso de días de vacaciones acumulados para extender el período de licencia.\n4. Las empleadas adoptantes también tienen derecho a una licencia de maternidad, comenzando desde la fecha de adopción.\n5. Todas las políticas de licencia están en conformidad con las leyes laborales nacionales y regionales.\n\n\n####################################################################################################\n\n\nPolíticas sobre licencias de maternidad\n# Proceso de Solicitud\n1. Notificar al supervisor y al departamento de recursos humanos sobre el embarazo lo antes posible.\n2. Presentar un certificado médico confirmando el embarazo y la fecha prevista del parto.\n3. Completar el formulario de solicitud de licencia de maternidad, disponible en el portal del empleado.\n4. Coordinar con recursos humanos para planificar la transición de trabajo y asegurar la cobertura durante la licencia.\n5. Mantener comunicación con recursos humanos durante la licencia para cualquier apoyo adicional.\n"},
    {"tool_call_id": "call_18", "role": "tool", "name": "doc_retrievalaugmented", "content": "Políticas sobre licencias de paternidad\n# Licencias de Paternidad\nNuestra empresa ofrece las siguientes políticas sobre licencias de paternidad:\n1. Los empleados tienen derecho a una licencia de paternidad de 2 semanas pagadas.\n2. La licencia debe tomarse dentro del primer mes del nacimiento del hijo.\n3. Durante la licencia, el empleado recibirá su salario completo.\n4. El empleado debe notificar a su supervisor y al departamento de recursos humanos con anticipación sobre la fecha de inicio de la licencia.\n5. En caso de nacimiento múltiple, la licencia de paternidad puede extenderse a 3 semanas.\n\n\n####################################################################################################\n\n\nPolíticas sobre licencias de paternidad\n# Beneficios Durante la Licencia de Paternidad\n1. Continuidad de todos los beneficios laborales, incluidos seguro médico y acumulación de vacaciones.\n2. Protección del puesto de trabajo, garantizando el regreso a la misma posición o a una similar al finalizar la licencia.\n3. Apoyo y asesoramiento durante el período de licencia a través del departamento de recursos humanos.\n4. Posibilidad de ajustar horarios y modalidades de trabajo al regresar de la licencia, de acuerdo a las necesidades del empleado.\n5. Acceso a programas de apoyo para nuevos padres, incluyendo grupos de apoyo y recursos educativos.\n\n\n####################################################################################################\n\n\nPolíticas sobre licencias de paternidad\n# Extensiones y Consideraciones Especiales\n1. En casos de nacimiento múltiple, la licencia de paternidad puede extenderse según las políticas de la empresa.\n2. Si el empleado requiere más tiempo debido a circunstancias especiales, deberá presentar una solicitud formal a recursos humanos.\n3. La empresa permite el uso de días de vacaciones acumulados para extender el período de licencia.\n4. Los empleados adoptantes también tienen derecho a una licencia de paternidad, comenzando desde la fecha de adopción.\n5. Todas las políticas de licencia están en conformidad con las leyes laborales nacionales y regionales.\n"},
    {"tool_call_id": "call_19", "role": "tool", "name": "doc_retrievalaugmented", "content": "Proceso para solicitar licencias de maternidad y paternidad\n# Solicitar Licencia de Maternidad\n1. Notificar al supervisor y al departamento de recursos humanos sobre el embarazo lo antes posible.\n2. Presentar un certificado médico confirmando el embarazo y la fecha prevista del parto.\n3. Completar el formulario de solicitud de licencia de maternidad, disponible en el portal del empleado.\n4. Coordinar con recursos humanos para planificar la transición de trabajo y asegurar la cobertura durante la licencia.\n5. Mantener comunicación con recursos humanos durante la licencia para cualquier apoyo adicional.\n\n####################################################################################################\n\nProceso para solicitar licencias de maternidad y paternidad\n# Requisitos y Documentación\n1. Certificado médico confirmando el embarazo y la fecha prevista del parto (maternidad).\n2. Formulario de solicitud de licencia debidamente completado y firmado.\n3. Cualquier documentación adicional que pueda ser requerida por recursos humanos.\n\n####################################################################################################\n\nProceso para solicitar licencias de maternidad y paternidad\n# Coordinación con Recursos Humanos\n1. Establecer un plan de transición con el supervisor para asegurar la continuidad del trabajo durante la licencia.\n2. Revisar y entender los beneficios disponibles durante la licencia con recursos humanos.\n3. Mantener una comunicación abierta con recursos humanos para cualquier ajuste necesario.\n4. Asegurar que todos los documentos y formularios estén completos y presentados a tiempo.\n5. Solicitar cualquier apoyo adicional necesario durante el período de licencia.\n\n####################################################################################################\n\nProceso para solicitar licencias de maternidad y paternidad\n# Regreso al Trabajo\n1. Notificar a recursos humanos y al supervisor con anticipación sobre la fecha de regreso al trabajo.\n2. Coordinar cualquier ajuste en el horario o modalidad de trabajo si es necesario.\n3. Participar en cualquier sesión de orientación o reinducción al regresar de la licencia.\n4. Revisar cualquier cambio en las políticas o procedimientos que hayan ocurrido durante la ausencia.\n5. Continuar con el plan de desarrollo profesional y aprovechar los recursos disponibles para padres en el lugar de trabajo."},
    {"tool_call_id": "call_20", "role": "tool", "name": "doc_retrievalaugmented", "content": "Proceso para solicitar licencias de maternidad y paternidad\n# Solicitar Licencia de Paternidad\n1. Notificar al supervisor y al departamento de recursos humanos sobre el nacimiento lo antes posible.\n2. Presentar una copia del certificado de nacimiento del hijo.\n3. Completar el formulario de solicitud de licencia de paternidad, disponible en el portal del empleado.\n4. Coordinar con recursos humanos para planificar la transición de trabajo y asegurar la cobertura durante la licencia.\n5. Mantener comunicación con recursos humanos durante la licencia para cualquier apoyo adicional.\n\n####################################################################################################\n\nProceso para solicitar licencias de maternidad y paternidad\n# Requisitos y Documentación\n1. Copia del certificado de nacimiento del hijo (paternidad).\n2. Formulario de solicitud de licencia debidamente completado y firmado.\n3. Cualquier documentación adicional que pueda ser requerida por recursos humanos.\n\n####################################################################################################\n\nProceso para solicitar licencias de maternidad y paternidad\n# Coordinación con Recursos Humanos\n1. Establecer un plan de transición con el supervisor para asegurar la continuidad del trabajo durante la licencia.\n2. Revisar y entender los beneficios disponibles durante la licencia con recursos humanos.\n3. Mantener una comunicación abierta con recursos humanos para cualquier ajuste necesario.\n4. Asegurar que todos los documentos y formularios estén completos y presentados a tiempo.\n5. Solicitar cualquier apoyo adicional necesario durante el período de licencia.\n\n####################################################################################################\n\nProceso para solicitar licencias de maternidad y paternidad\n# Regreso al Trabajo\n1. Notificar a recursos humanos y al supervisor con anticipación sobre la fecha de regreso al trabajo.\n2. Coordinar cualquier ajuste en el horario o modalidad de trabajo si es necesario.\n3. Participar en cualquier sesión de orientación o reinducción al regresar de la licencia.\n4. Revisar cualquier cambio en las políticas o procedimientos que hayan ocurrido durante la ausencia.\n5. Continuar con el plan de desarrollo profesional y aprovechar los recursos disponibles para padres en el lugar de trabajo."},
    {"role": "assistant", "content": "Nuestra empresa tiene políticas específicas sobre licencias de maternidad y paternidad, y aquí tienes la información sobre cómo solicitarlas:\n\n### Políticas sobre Licencias de Maternidad\n1. Las empleadas tienen derecho a una licencia de maternidad de 18 semanas pagadas.\n2. La licencia puede comenzar dos semanas antes de la fecha prevista del parto.\n3. Durante la licencia, la empleada recibirá su salario completo.\n4. La empleada debe presentar un certificado médico confirmando la fecha de parto prevista.\n5. En caso de complicaciones médicas, la licencia puede extenderse según las recomendaciones del médico.\n\n\n####################################################################################################\n\n\n6. Continuidad de todos los beneficios laborales, incluidos seguro médico y acumulación de vacaciones.\n7. Protección del puesto de trabajo, garantizando el regreso a la misma posición o a una similar al finalizar la licencia.\n8. Asesoramiento y apoyo durante el período de licencia a través del departamento de recursos humanos.\n9. Posibilidad de ajustar horarios y modalidades de trabajo al regresar de la licencia.\n10. Acceso a programas de apoyo para nuevas madres, incluyendo grupos de apoyo y recursos educativos.\n\n\n####################################################################################################\n\n\n11. En casos de nacimiento prematuro, la licencia de maternidad se ajustará para asegurar el tiempo de recuperación necesario.\n12. Si la empleada requiere más tiempo debido a complicaciones, deberá presentar un certificado médico adicional.\n13. La empresa permite el uso de días de vacaciones acumulados para extender el período de licencia.\n14. Las empleadas adoptantes también tienen derecho a una licencia de maternidad, comenzando desde la fecha de adopción.\n15. Todas las políticas de licencia están en conformidad con las leyes laborales nacionales y regionales.\n\n\n####################################################################################################\n\n\n### Políticas sobre Licencias de Paternidad\n1. Los empleados tienen derecho a una licencia de paternidad de 2 semanas pagadas.\n2. La licencia debe tomarse dentro del primer mes del nacimiento del hijo.\n3. Durante la licencia, el empleado recibirá su salario completo.\n4. El empleado debe notificar a su supervisor y al departamento de recursos humanos con anticipación sobre la fecha de inicio de la licencia.\n5. En caso de nacimiento múltiple, la licencia de paternidad puede extenderse a 3 semanas.\n\n\n####################################################################################################\n\n\n6. Continuidad de todos los beneficios laborales, incluidos seguro médico y acumulación de vacaciones.\n7. Protección del puesto de trabajo, garantizando el regreso a la misma posición o a una similar al finalizar la licencia.\n8. Apoyo y asesoramiento durante el período de licencia a través del departamento de recursos humanos.\n9. Posibilidad de ajustar horarios y modalidades de trabajo al regresar de la licencia.\n10. Acceso a programas de apoyo para nuevos padres, incluyendo grupos de apoyo y recursos educativos.\n\n\n####################################################################################################\n\n\n### Cómo Solicitar Licencias de Maternidad y Paternidad\n1. Notificar al supervisor y al departamento de recursos humanos sobre el embarazo o nacimiento lo antes posible.\n2. Presentar un certificado médico confirmando el embarazo y la fecha prevista del parto, o una copia del certificado de nacimiento del hijo.\n3. Completar el formulario de solicitud de licencia, disponible en el portal del empleado.\n4. Coordinar con recursos humanos para planificar la transición de trabajo y asegurar la cobertura durante la licencia.\n5. Mantener comunicación con recursos humanos durante la licencia para cualquier apoyo adicional.\n\n\n####################################################################################################\n\n\n6. Establecer un plan de transición con el supervisor para asegurar la continuidad del trabajo durante la licencia.\n7. Revisar y entender los beneficios disponibles durante la licencia con recursos humanos.\n8. Mantener una comunicación abierta con recursos humanos para cualquier ajuste necesario.\n9. Asegurar que todos los documentos y formularios estén completos y presentados a tiempo.\n10. Solicitar cualquier apoyo adicional necesario durante el período de licencia.\n\n\n####################################################################################################\n\n\n11. Notificar a recursos humanos y al supervisor con anticipación sobre la fecha de regreso al trabajo.\n12. Coordinar cualquier ajuste en el horario o modalidad de trabajo si es necesario.\n13. Participar en cualquier sesión de orientación o reinducción al regresar de la licencia.\n14. Revisar cualquier cambio en las políticas o procedimientos que hayan ocurrido durante la ausencia.\n15. Continuar con el plan de desarrollo profesional y aprovechar los recursos disponibles para padres en el lugar de trabajo."},
    # example 5
    {"role": "user", "content": "¿Qué opciones de inversión ofrece la empresa para los empleados y cómo puedo participar en ellas?"},
    {"role": "assistant", "content": None, "function_call": None, "tool_calls": [
        {"id": "call_21", "function": {"arguments": "{\"query\":\"¿Qué opciones de inversión ofrece la empresa para los empleados?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_22", "function": {"arguments": "{\"query\":\"¿Cómo puedo participar en las opciones de inversión ofrecidas por la empresa?\"}", "name": "doc_retrievalaugmented"}, "type": "function"}
    ]},
    {"tool_call_id": "call_21", "role": "tool", "name": "doc_retrievalaugmented", "content": "Opciones de inversión para empleados\n# Opciones de Inversión\nNuestra empresa ofrece las siguientes opciones de inversión para empleados:\n1. Planes de ahorro con deducción de nómina para invertir en fondos mutuos.\n2. Acceso a la compra de acciones de la empresa a precios preferenciales.\n3. Programas de inversión en fondos de jubilación con contribuciones igualadas por la empresa.\n4. Opciones de bonos corporativos con tasas de interés competitivas.\n5. Cuentas de ahorro para educación con beneficios fiscales.\n\n\n####################################################################################################\n\n\nOpciones de inversión para empleados\n# Planes de Ahorro y Fondos Mutuos\n1. Planes de ahorro automático con deducción de nómina.\n2. Oportunidades de inversión en una variedad de fondos mutuos gestionados profesionalmente.\n3. Asesoramiento financiero gratuito para ayudar a los empleados a elegir las mejores opciones de inversión.\n4. Flexibilidad para ajustar las contribuciones en cualquier momento.\n5. Informes periódicos sobre el rendimiento de las inversiones.\n\n\n####################################################################################################\n\n\nOpciones de inversión para empleados\n# Compra de Acciones de la Empresa\n1. Acceso a la compra de acciones de la empresa a precios preferenciales.\n2. Programas de compra de acciones con descuento para empleados de larga data.\n3. Posibilidad de reinvertir los dividendos recibidos en más acciones.\n4. Sesiones informativas sobre el mercado de valores y la inversión en acciones.\n5. Oportunidades de participar en la junta de accionistas y votar sobre decisiones corporativas.\n\n\n####################################################################################################\n\n\nOpciones de inversión para empleados\n# Fondos de Jubilación\n1. Programas de inversión en fondos de jubilación con contribuciones igualadas por la empresa.\n2. Asesoramiento financiero para la planificación de la jubilación.\n3. Flexibilidad para elegir entre diferentes tipos de fondos de jubilación.\n4. Beneficios fiscales por las contribuciones a los fondos de jubilación.\n5. Informes anuales sobre el rendimiento y las proyecciones de los fondos de jubilación.\n\n\n####################################################################################################\n\n\nOpciones de inversión para empleados\n# Bonos Corporativos\n1. Opciones de inversión en bonos corporativos emitidos por la empresa.\n2. Tasas de interés competitivas en comparación con otros instrumentos de deuda.\n3. Plazos de inversión flexibles para adaptarse a las necesidades de los empleados.\n4. Información detallada sobre los términos y condiciones de los bonos corporativos.\n5. Oportunidad de diversificar la cartera de inversiones con instrumentos de deuda seguros.\n\n\n####################################################################################################\n\n\nOpciones de inversión para empleados\n# Cuentas de Ahorro para Educación\n1. Cuentas de ahorro para educación con beneficios fiscales.\n2. Oportunidades de inversión en planes de ahorro para la educación de los hijos.\n3. Flexibilidad para ajustar las contribuciones y los beneficiarios de las cuentas de ahorro.\n4. Asesoramiento financiero para maximizar los beneficios fiscales y de inversión.\n5. Informes periódicos sobre el rendimiento de las cuentas de ahorro para educación."},
    {"tool_call_id": "call_22", "role": "tool", "name": "doc_retrievalaugmented", "content": "Cómo participar en las opciones de inversión\n# Participar en Opciones de Inversión\nPara participar en las opciones de inversión ofrecidas por la empresa, sigue estos pasos:\n1. Visita el portal del empleado y navega hasta la sección de inversiones.\n2. Revisa las diferentes opciones de inversión disponibles y selecciona las que te interesen.\n3. Completa el formulario de inscripción en línea para cada opción de inversión.\n4. Consulta con tu asesor financiero para obtener recomendaciones personalizadas.\n5. Una vez inscrito, realiza tus contribuciones a través de la deducción de nómina o pagos directos.\n\n\n####################################################################################################\n\n\nCómo participar en las opciones de inversión\n# Inscripción en Planes de Ahorro y Fondos Mutuos\n1. Accede al portal del empleado y selecciona la opción de planes de ahorro.\n2. Completa el formulario de inscripción con los detalles de la deducción de nómina.\n3. Selecciona los fondos mutuos en los que deseas invertir y el porcentaje de tu contribución.\n4. Confirma tu inscripción y revisa los informes periódicos sobre el rendimiento de tus inversiones.\n5. Ajusta tus contribuciones en cualquier momento a través del portal del empleado.\n\n\n####################################################################################################\n\n\nCómo participar en las opciones de inversión\n# Compra de Acciones de la Empresa\n1. Visita la sección de compra de acciones en el portal del empleado.\n2. Revisa los términos y condiciones del programa de compra de acciones.\n3. Completa el formulario de inscripción para participar en el programa.\n4. Realiza tus compras de acciones a través del portal o mediante tu corredor de bolsa.\n5. Participa en las sesiones informativas y mantente al día con el rendimiento de las acciones de la empresa.\n\n\n####################################################################################################\n\n\nCómo participar en las opciones de inversión\n# Inscripción en Fondos de Jubilación\n1. Dirígete a la sección de fondos de jubilación en el portal del empleado.\n2. Revisa las diferentes opciones de fondos de jubilación y sus beneficios.\n3. Completa el formulario de inscripción para el fondo de jubilación de tu elección.\n4. Consulta con tu asesor financiero para maximizar los beneficios fiscales y de inversión.\n5. Realiza tus contribuciones a través de la deducción de nómina y revisa los informes anuales sobre el rendimiento del fondo.\n\n\n####################################################################################################\n\n\nCómo participar en las opciones de inversión\n# Inversión en Bonos Corporativos\n1. Accede a la sección de bonos corporativos en el portal del empleado.\n2. Revisa los términos y condiciones de los bonos corporativos disponibles.\n3. Completa el formulario de inscripción para la compra de bonos.\n4. Realiza tus inversiones a través del portal o mediante tu corredor de bonos.\n5. Mantente informado sobre el rendimiento de los bonos y los pagos de intereses.\n\n\n####################################################################################################\n\n\nCómo participar en las opciones de inversión\n# Inscripción en Cuentas de Ahorro para Educación\n1. Visita la sección de cuentas de ahorro para educación en el portal del empleado.\n2. Revisa los beneficios fiscales y las opciones de inversión disponibles.\n3. Completa el formulario de inscripción y selecciona los beneficiarios de la cuenta.\n4. Realiza tus contribuciones a través de la deducción de nómina o pagos directos.\n5. Revisa los informes periódicos sobre el rendimiento de las cuentas de ahorro y ajusta tus contribuciones según sea necesario."},
    {"role": "assistant", "content": "Nuestra empresa ofrece varias opciones de inversión para empleados, y aquí tienes la información sobre cómo participar en ellas:\n\n### Opciones de Inversión para Empleados\n1. Planes de ahorro con deducción de nómina para invertir en fondos mutuos.\n2. Acceso a la compra de acciones de la empresa a precios preferenciales.\n3. Programas de inversión en fondos de jubilación con contribuciones igualadas por la empresa.\n4. Opciones de bonos corporativos con tasas de interés competitivas.\n5. Cuentas de ahorro para educación con beneficios fiscales.\n\n\n####################################################################################################\n\n\n6. Planes de ahorro automático con deducción de nómina.\n7. Oportunidades de inversión en una variedad de fondos mutuos gestionados profesionalmente.\n8. Asesoramiento financiero gratuito para ayudar a los empleados a elegir las mejores opciones de inversión.\n9. Flexibilidad para ajustar las contribuciones en cualquier momento.\n10. Informes periódicos sobre el rendimiento de las inversiones.\n\n\n####################################################################################################\n\n\n11. Acceso a la compra de acciones de la empresa a precios preferenciales.\n12. Programas de compra de acciones con descuento para empleados de larga data.\n13. Posibilidad de reinvertir los dividendos recibidos en más acciones.\n14. Sesiones informativas sobre el mercado de valores y la inversión en acciones.\n15. Oportunidades de participar en la junta de accionistas y votar sobre decisiones corporativas.\n\n\n####################################################################################################\n\n\n16. Programas de inversión en fondos de jubilación con contribuciones igualadas por la empresa.\n17. Asesoramiento financiero para la planificación de la jubilación.\n18. Flexibilidad para elegir entre diferentes tipos de fondos de jubilación.\n19. Beneficios fiscales por las contribuciones a los fondos de jubilación.\n20. Informes anuales sobre el rendimiento y las proyecciones de los fondos de jubilación.\n\n\n####################################################################################################\n\n\n21. Opciones de inversión en bonos corporativos emitidos por la empresa.\n22. Tasas de interés competitivas en comparación con otros instrumentos de deuda.\n23. Plazos de inversión flexibles para adaptarse a las necesidades de los empleados.\n24. Información detallada sobre los términos y condiciones de los bonos corporativos.\n25. Oportunidad de diversificar la cartera de inversiones con instrumentos de deuda seguros.\n\n\n####################################################################################################\n\n\n### Cómo Participar en las Opciones de Inversión\n1. Visita el portal del empleado y navega hasta la sección de inversiones.\n2. Revisa las diferentes opciones de inversión disponibles y selecciona las que te interesen.\n3. Completa el formulario de inscripción en línea para cada opción de inversión.\n4. Consulta con tu asesor financiero para obtener recomendaciones personalizadas.\n5. Una vez inscrito, realiza tus contribuciones a través de la deducción de nómina o pagos directos.\n\n\n####################################################################################################\n\n\n6. Accede al portal del empleado y selecciona la opción de planes de ahorro.\n7. Completa el formulario de inscripción con los detalles de la deducción de nómina.\n8. Selecciona los fondos mutuos en los que deseas invertir y el porcentaje de tu contribución.\n9. Confirma tu inscripción y revisa los informes periódicos sobre el rendimiento de tus inversiones.\n10. Ajusta tus contribuciones en cualquier momento a través del portal del empleado.\n\n\n####################################################################################################\n\n\n11. Visita la sección de compra de acciones en el portal del empleado.\n12. Revisa los términos y condiciones del programa de compra de acciones.\n13. Completa el formulario de inscripción para participar en el programa.\n14. Realiza tus compras de acciones a través del portal o mediante tu corredor de bolsa.\n15. Participa en las sesiones informativas y mantente al día con el rendimiento de las acciones de la empresa.\n\n\n####################################################################################################\n\n\n16. Dirígete a la sección de fondos de jubilación en el portal del empleado.\n17. Revisa las diferentes opciones de fondos de jubilación y sus beneficios.\n18. Completa el formulario de inscripción para el fondo de jubilación de tu elección.\n19. Consulta con tu asesor financiero para maximizar los beneficios fiscales y de inversión.\n20. Realiza tus contribuciones a través de la deducción de nómina y revisa los informes anuales sobre el rendimiento del fondo.\n\n\n####################################################################################################\n\n\n21. Accede a la sección de bonos corporativos en el portal del empleado.\n22. Revisa los términos y condiciones de los bonos corporativos disponibles.\n23. Completa el formulario de inscripción para la compra de bonos.\n24. Realiza tus inversiones a través del portal o mediante tu corredor de bonos.\n25. Mantente informado sobre el rendimiento de los bonos y los pagos de intereses.\n\n\n####################################################################################################\n\n\n26. Visita la sección de cuentas de ahorro para educación en el portal del empleado.\n27. Revisa los beneficios fiscales y las opciones de inversión disponibles.\n28. Completa el formulario de inscripción y selecciona los beneficiarios de la cuenta.\n29. Realiza tus contribuciones a través de la deducción de nómina o pagos directos.\n30. Revisa los informes periódicos sobre el rendimiento de las cuentas de ahorro y ajusta tus contribuciones según sea necesario."},
    # example 6
    {"role": "user", "content": "¿Qué beneficios ofrece la empresa para la salud y el bienestar de los empleados y cómo puedo acceder a ellos?"},
    {"role": "assistant", "content": None, "function_call": None, "tool_calls": [
        {"id": "call_23", "function": {"arguments": "{\"query\":\"¿Qué beneficios ofrece la empresa para la salud y el bienestar de los empleados?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_24", "function": {"arguments": "{\"query\":\"¿Cómo puedo acceder a los beneficios de salud y bienestar ofrecidos por la empresa?\"}", "name": "doc_retrievalaugmented"}, "type": "function"}
    ]},
    {"tool_call_id": "call_23", "role": "tool", "name": "doc_retrievalaugmented", "content": "Beneficios de salud y bienestar para empleados\n# Beneficios de Salud y Bienestar\nNuestra empresa ofrece los siguientes beneficios de salud y bienestar para los empleados:\n1. Seguro médico integral que cubre consultas, hospitalización y medicamentos.\n2. Programas de bienestar mental, incluyendo sesiones de terapia y asesoramiento.\n3. Membresías a gimnasios y acceso a clases de fitness en línea.\n4. Programas de bienestar financiero con asesoramiento y planificación financiera.\n5. Campañas de vacunación y chequeos médicos anuales.\n\n\n####################################################################################################\n\n\nBeneficios de salud y bienestar para empleados\n# Seguro Médico\n1. Cobertura de consultas médicas generales y especializadas.\n2. Hospitalización y tratamientos médicos necesarios.\n3. Cobertura de medicamentos recetados y terapias.\n4. Acceso a una red de clínicas y hospitales de alta calidad.\n5. Asistencia médica de emergencia las 24 horas.\n\n\n####################################################################################################\n\n\nBeneficios de salud y bienestar para empleados\n# Bienestar Mental\n1. Sesiones de terapia y asesoramiento con profesionales licenciados.\n2. Programas de reducción de estrés y manejo de la ansiedad.\n3. Acceso a recursos de bienestar mental en línea.\n4. Grupos de apoyo y talleres sobre temas de salud mental.\n5. Línea de ayuda confidencial disponible las 24 horas.\n\n\n####################################################################################################\n\n\nBeneficios de salud y bienestar para empleados\n# Fitness y Ejercicio\n1. Membresías a gimnasios locales subsidiadas por la empresa.\n2. Clases de fitness en línea, incluyendo yoga, pilates y entrenamiento de fuerza.\n3. Programas de bienestar físico personalizados.\n4. Desafíos y eventos de fitness organizados por la empresa.\n5. Acceso a recursos y aplicaciones de fitness en línea.\n\n\n####################################################################################################\n\n\nBeneficios de salud y bienestar para empleados\n# Bienestar Financiero\n1. Asesoramiento financiero personalizado y planificación de inversiones.\n2. Programas de ahorro y planificación para la jubilación.\n3. Seminarios y talleres sobre gestión financiera.\n4. Acceso a recursos de educación financiera en línea.\n5. Programas de asistencia para la gestión de deudas.\n"},
    {"tool_call_id": "call_24", "role": "tool", "name": "doc_retrievalaugmented", "content": "Cómo acceder a los beneficios de salud y bienestar\n# Acceso a Beneficios de Salud\nPara acceder a los beneficios de salud y bienestar ofrecidos por la empresa, sigue estos pasos:\n1. Visita el portal del empleado y navega hasta la sección de beneficios de salud.\n2. Revisa las diferentes opciones de beneficios disponibles y selecciona las que te interesen.\n3. Completa el formulario de inscripción en línea para cada beneficio.\n4. Consulta con el departamento de recursos humanos para obtener asistencia y recomendaciones.\n5. Una vez inscrito, comienza a utilizar los beneficios según las instrucciones proporcionadas.\n\n\n####################################################################################################\n\n\nCómo acceder a los beneficios de salud y bienestar\n# Inscripción en Seguro Médico\n1. Accede al portal del empleado y selecciona la opción de seguro médico.\n2. Completa el formulario de inscripción con tus datos personales y familiares.\n3. Selecciona el plan de seguro que mejor se adapte a tus necesidades.\n4. Envía el formulario de inscripción y espera la confirmación de recursos humanos.\n5. Recibe tu tarjeta de seguro médico y comienza a utilizar los servicios cubiertos.\n\n\n####################################################################################################\n\n\nCómo acceder a los beneficios de salud y bienestar\n# Participación en Programas de Bienestar Mental\n1. Visita la sección de bienestar mental en el portal del empleado.\n2. Revisa los programas y recursos disponibles y selecciona los que te interesen.\n3. Completa el formulario de inscripción para las sesiones de terapia y asesoramiento.\n4. Consulta con un profesional de bienestar mental para programar tus sesiones.\n5. Participa en grupos de apoyo y talleres según tu disponibilidad.\n\n\n####################################################################################################\n\n\nCómo acceder a los beneficios de salud y bienestar\n# Membresías a Gimnasios y Clases de Fitness\n1. Dirígete a la sección de fitness y ejercicio en el portal del empleado.\n2. Revisa las opciones de membresías a gimnasios y clases de fitness en línea.\n3. Completa el formulario de inscripción y selecciona tus preferencias.\n4. Recibe la confirmación de tu membresía y comienza a asistir al gimnasio o a las clases en línea.\n5. Participa en los desafíos y eventos de fitness organizados por la empresa.\n\n\n####################################################################################################\n\n\nCómo acceder a los beneficios de salud y bienestar\n# Programas de Bienestar Financiero\n1. Accede a la sección de bienestar financiero en el portal del empleado.\n2. Revisa los programas y recursos disponibles y selecciona los que te interesen.\n3. Completa el formulario de inscripción para asesoramiento financiero y planificación de inversiones.\n4. Programa una sesión con un asesor financiero para discutir tus objetivos y necesidades.\n5. Participa en seminarios y talleres de educación financiera según tu disponibilidad."},
    {"role": "assistant", "content": "Nuestra empresa ofrece varios beneficios para la salud y el bienestar de los empleados, y aquí tienes la información sobre cómo acceder a ellos:\n\n### Beneficios de Salud y Bienestar para Empleados\n1. Seguro médico integral que cubre consultas, hospitalización y medicamentos.\n2. Programas de bienestar mental, incluyendo sesiones de terapia y asesoramiento.\n3. Membresías a gimnasios y acceso a clases de fitness en línea.\n4. Programas de bienestar financiero con asesoramiento y planificación financiera.\n5. Campañas de vacunación y chequeos médicos anuales.\n\n\n####################################################################################################\n\n\n6. Cobertura de consultas médicas generales y especializadas.\n7. Hospitalización y tratamientos médicos necesarios.\n8. Cobertura de medicamentos recetados y terapias.\n9. Acceso a una red de clínicas y hospitales de alta calidad.\n10. Asistencia médica de emergencia las 24 horas.\n\n\n####################################################################################################\n\n\n11. Sesiones de terapia y asesoramiento con profesionales licenciados.\n12. Programas de reducción de estrés y manejo de la ansiedad.\n13. Acceso a recursos de bienestar mental en línea.\n14. Grupos de apoyo y talleres sobre temas de salud mental.\n15. Línea de ayuda confidencial disponible las 24 horas.\n\n\n####################################################################################################\n\n\n16. Membresías a gimnasios locales subsidiadas por la empresa.\n17. Clases de fitness en línea, incluyendo yoga, pilates y entrenamiento de fuerza.\n18. Programas de bienestar físico personalizados.\n19. Desafíos y eventos de fitness organizados por la empresa.\n20. Acceso a recursos y aplicaciones de fitness en línea.\n\n\n####################################################################################################\n\n\n21. Asesoramiento financiero personalizado y planificación de inversiones.\n22. Programas de ahorro y planificación para la jubilación.\n23. Seminarios y talleres sobre gestión financiera.\n24. Acceso a recursos de educación financiera en línea.\n25. Programas de asistencia para la gestión de deudas.\n\n\n### Cómo Acceder a los Beneficios de Salud y Bienestar\n1. Visita el portal del empleado y navega hasta la sección de beneficios de salud.\n2. Revisa las diferentes opciones de beneficios disponibles y selecciona las que te interesen.\n3. Completa el formulario de inscripción en línea para cada beneficio.\n4. Consulta con el departamento de recursos humanos para obtener asistencia y recomendaciones.\n5. Una vez inscrito, comienza a utilizar los beneficios según las instrucciones proporcionadas.\n\n\n####################################################################################################\n\n\n6. Accede al portal del empleado y selecciona la opción de seguro médico.\n7. Completa el formulario de inscripción con tus datos personales y familiares.\n8. Selecciona el plan de seguro que mejor se adapte a tus necesidades.\n9. Envía el formulario de inscripción y espera la confirmación de recursos humanos.\n10. Recibe tu tarjeta de seguro médico y comienza a utilizar los servicios cubiertos.\n\n\n####################################################################################################\n\n\n11. Visita la sección de bienestar mental en el portal del empleado.\n12. Revisa los programas y recursos disponibles y selecciona los que te interesen.\n13. Completa el formulario de inscripción para las sesiones de terapia y asesoramiento.\n14. Consulta con un profesional de bienestar mental para programar tus sesiones.\n15. Participa en grupos de apoyo y talleres según tu disponibilidad.\n\n\n####################################################################################################\n\n\n16. Dirígete a la sección de fitness y ejercicio en el portal del empleado.\n17. Revisa las opciones de membresías a gimnasios y clases de fitness en línea.\n18. Completa el formulario de inscripción y selecciona tus preferencias.\n19. Recibe la confirmación de tu membresía y comienza a asistir al gimnasio o a las clases en línea.\n20. Participa en los desafíos y eventos de fitness organizados por la empresa.\n\n\n####################################################################################################\n\n\n21. Accede a la sección de bienestar financiero en el portal del empleado.\n22. Revisa los programas y recursos disponibles y selecciona los que te interesen.\n23. Completa el formulario de inscripción para asesoramiento financiero y planificación de inversiones.\n24. Programa una sesión con un asesor financiero para discutir tus objetivos y necesidades.\n25. Participa en seminarios y talleres de educación financiera según tu disponibilidad."},
    # example 7
    {"role": "user", "content": "¿Cuáles son las diferencias entre los beneficios de salud y bienestar ofrecidos por la empresa y los programas de bienestar financiero?"},
    {"role": "assistant", "content": None, "function_call": None, "tool_calls": [
        {"id": "call_25", "function": {"arguments": "{\"query\":\"¿Qué beneficios ofrece la empresa para la salud y el bienestar de los empleados?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_26", "function": {"arguments": "{\"query\":\"¿Qué programas de bienestar financiero ofrece la empresa?\"}", "name": "doc_retrievalaugmented"}, "type": "function"}
    ]},
    {"tool_call_id": "call_25", "role": "tool", "name": "doc_retrievalaugmented", "content": "Beneficios de salud y bienestar para empleados\n# Beneficios de Salud y Bienestar\nNuestra empresa ofrece los siguientes beneficios de salud y bienestar para los empleados:\n1. Seguro médico integral que cubre consultas, hospitalización y medicamentos.\n2. Programas de bienestar mental, incluyendo sesiones de terapia y asesoramiento.\n3. Membresías a gimnasios y acceso a clases de fitness en línea.\n4. Programas de bienestar financiero con asesoramiento y planificación financiera.\n5. Campañas de vacunación y chequeos médicos anuales.\n\n\n####################################################################################################\n\n\nBeneficios de salud y bienestar para empleados\n# Seguro Médico\n1. Cobertura de consultas médicas generales y especializadas.\n2. Hospitalización y tratamientos médicos necesarios.\n3. Cobertura de medicamentos recetados y terapias.\n4. Acceso a una red de clínicas y hospitales de alta calidad.\n5. Asistencia médica de emergencia las 24 horas.\n\n\n####################################################################################################\n\n\nBeneficios de salud y bienestar para empleados\n# Bienestar Mental\n1. Sesiones de terapia y asesoramiento con profesionales licenciados.\n2. Programas de reducción de estrés y manejo de la ansiedad.\n3. Acceso a recursos de bienestar mental en línea.\n4. Grupos de apoyo y talleres sobre temas de salud mental.\n5. Línea de ayuda confidencial disponible las 24 horas.\n\n\n####################################################################################################\n\n\nBeneficios de salud y bienestar para empleados\n# Fitness y Ejercicio\n1. Membresías a gimnasios locales subsidiadas por la empresa.\n2. Clases de fitness en línea, incluyendo yoga, pilates y entrenamiento de fuerza.\n3. Programas de bienestar físico personalizados.\n4. Desafíos y eventos de fitness organizados por la empresa.\n5. Acceso a recursos y aplicaciones de fitness en línea."},
    {"tool_call_id": "call_26", "role": "tool", "name": "doc_retrievalaugmented", "content": "Programas de bienestar financiero para empleados\n# Bienestar Financiero\n1. Asesoramiento financiero personalizado y planificación de inversiones.\n2. Programas de ahorro y planificación para la jubilación.\n3. Seminarios y talleres sobre gestión financiera.\n4. Acceso a recursos de educación financiera en línea.\n5. Programas de asistencia para la gestión de deudas.\n\n\n####################################################################################################\n\n\nProgramas de bienestar financiero para empleados\n# Ahorro y Planificación\n1. Programas de ahorro a largo plazo.\n2. Planes de jubilación con beneficios fiscales.\n3. Asesoramiento sobre inversión en bienes raíces y otros activos.\n4. Planificación de seguros y gestión de riesgos.\n5. Estrategias de optimización fiscal.\n\n\n####################################################################################################\n\n\nProgramas de bienestar financiero para empleados\n# Educación Financiera\n1. Talleres sobre presupuestos y manejo del dinero.\n2. Seminarios sobre inversiones y mercados financieros.\n3. Recursos educativos sobre planificación financiera personal.\n4. Asesoramiento sobre créditos y préstamos.\n5. Información sobre seguros y productos financieros.\n\n\n####################################################################################################\n\n\nProgramas de bienestar financiero para empleados\n# Gestión de Deudas\n1. Programas de consolidación de deudas.\n2. Asesoramiento sobre reducción de deudas.\n3. Estrategias de pago de deudas prioritarias.\n4. Recursos sobre prevención de deudas futuras.\n5. Asistencia legal en casos de deudas complejas."},
    {"role": "assistant", "content": "Nuestra empresa ofrece una amplia gama de beneficios de salud y bienestar, así como programas de bienestar financiero para los empleados. Aquí están las principales diferencias entre ellos:\n\n### Beneficios de Salud y Bienestar\n1. Seguro médico integral que cubre consultas, hospitalización y medicamentos.\n2. Programas de bienestar mental, incluyendo sesiones de terapia y asesoramiento.\n3. Membresías a gimnasios y acceso a clases de fitness en línea.\n4. Campañas de vacunación y chequeos médicos anuales.\n5. Asistencia médica de emergencia las 24 horas.\n\n\n####################################################################################################\n\n\n6. Sesiones de terapia y asesoramiento con profesionales licenciados.\n7. Programas de reducción de estrés y manejo de la ansiedad.\n8. Grupos de apoyo y talleres sobre temas de salud mental.\n9. Membresías a gimnasios locales subsidiadas por la empresa.\n10. Clases de fitness en línea, incluyendo yoga, pilates y entrenamiento de fuerza.\n\n\n### Programas de Bienestar Financiero\n1. Asesoramiento financiero personalizado y planificación de inversiones.\n2. Programas de ahorro y planificación para la jubilación.\n3. Seminarios y talleres sobre gestión financiera.\n4. Acceso a recursos de educación financiera en línea.\n5. Programas de asistencia para la gestión de deudas.\n\n\n####################################################################################################\n\n\n6. Estrategias de optimización fiscal.\n7. Asesoramiento sobre créditos y préstamos.\n8. Información sobre seguros y productos financieros.\n9. Recursos educativos sobre planificación financiera personal.\n10. Asesoramiento sobre reducción de deudas.\n\n\nEn resumen, mientras que los beneficios de salud y bienestar se centran en aspectos físicos y mentales de la salud, los programas de bienestar financiero se enfocan en la gestión financiera y planificación a largo plazo para los empleados."},
    # example 8
    {"role": "user", "content": "¿Cuál es la diferencia entre el Plan A y el Plan B de seguro médico en términos de cobertura y costos y cuál me recomendarías según mi situación actual (Usuario con enfermedades crónicas que requiere consultas frecuentes. Necesita acceso a una amplia red de clínicas y hospitales. Busca minimizar costos de medicamentos recetados. Presupuesto mensual limitado.)?"},
    {"role": "assistant", "content": None, "function_call": None, "tool_calls": [
        {"id": "call_27", "function": {"arguments": "{\"query\":\"¿Cuáles son los detalles del Plan A de seguro médico en términos de cobertura y costos?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_28", "function": {"arguments": "{\"query\":\"¿Cuáles son los detalles del Plan B de seguro médico en términos de cobertura y costos?\"}", "name": "doc_retrievalaugmented"}, "type": "function"}
    ]},
    {"tool_call_id": "call_27", "role": "tool", "name": "doc_retrievalaugmented", "content": "Detalles del Plan A de Seguro Médico\n# Plan A\n1. Cobertura de consultas médicas generales y especializadas.\n2. Hospitalización y tratamientos médicos necesarios.\n3. Cobertura de medicamentos recetados y terapias.\n4. Acceso a una red de clínicas y hospitales de alta calidad.\n5. Costos: Prima mensual de $50, copago de $10 por consulta.\n\n\n####################################################################################################\n\n\n"},
    {"tool_call_id": "call_28", "role": "tool", "name": "doc_retrievalaugmented", "content": "Detalles del Plan B de Seguro Médico\n# Plan B\n1. Cobertura de consultas médicas generales.\n2. Hospitalización y tratamientos médicos necesarios con un límite anual.\n3. Cobertura parcial de medicamentos recetados.\n4. Acceso a una red limitada de clínicas y hospitales.\n5. Costos: Prima mensual de $30, copago de $20 por consulta.\n\n\n####################################################################################################\n\n\n"},
    {"role": "assistant", "content": "La diferencia principal entre el Plan A y el Plan B de seguro médico radica en la cobertura y los costos. El Plan A ofrece una cobertura más amplia que incluye consultas médicas especializadas, una red de clínicas y hospitales de alta calidad, y una mejor cobertura de medicamentos recetados. Sin embargo, su prima mensual es más alta ($50) con un copago de $10 por consulta. Por otro lado, el Plan B tiene una prima mensual más baja ($30) y un copago más alto ($20), con una cobertura más limitada.\n\nDado tu perfil y situación actual, te recomendaría el Plan A, ya que tienes enfermedades crónicas que requieren consultas frecuentes y necesitas una amplia red de clínicas y hospitales. Aunque el costo mensual es mayor, la cobertura adicional y los menores costos de medicamentos recetados probablemente compensarán la diferencia en la prima."},
    # example 9
    {"role": "user", "content": "¿Cuáles son las opciones de financiamiento disponibles para una pequeña empresa y cómo puedo solicitar un préstamo para expandir mi negocio?"},
    {"role": "assistant", "content": None, "function_call": None, "tool_calls": [
        {"id": "call_29", "function": {"arguments": "{\"query\":\"¿Cuáles son las opciones de financiamiento disponibles para una pequeña empresa?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_30", "function": {"arguments": "{\"query\":\"¿Cómo puedo solicitar un préstamo para expandir mi negocio que es una pequeña empresa?\"}", "name": "doc_retrievalaugmented"}, "type": "function"}
    ]},
    {"tool_call_id": "call_29", "role": "tool", "name": "doc_retrievalaugmented", "content": "Opciones de Financiamiento para Pequeñas Empresas\n# Opciones de Financiamiento\n1. Préstamos bancarios tradicionales.\n2. Líneas de crédito.\n3. Préstamos de la Administración de Pequeñas Empresas (SBA).\n4. Financiamiento de equipos.\n5. Factoring de cuentas por cobrar.\n6. Inversores ángeles.\n7. Capital de riesgo.\n8. Crowdfunding.\n9. Subvenciones y ayudas gubernamentales.\n\n\n####################################################################################################\n\n\n"},
    {"tool_call_id": "call_30", "role": "tool", "name": "doc_retrievalaugmented", "content": "Pasos para Solicitar un Préstamo para Expandir pequeñas y medianas empresas\n# Pasos\n1. Evaluar tus necesidades financieras y determinar el monto del préstamo necesario.\n2. Preparar un plan de negocios detallado que explique cómo se utilizarán los fondos y cómo se espera que el negocio crezca.\n3. Reunir la documentación financiera necesaria, incluyendo estados financieros, declaraciones de impuestos y proyecciones financieras.\n4. Investigar y comparar diferentes opciones de préstamo para encontrar la que mejor se adapte a tus necesidades.\n5. Completar y enviar la solicitud de préstamo, incluyendo toda la documentación requerida.\n6. Asistir a entrevistas o reuniones con los prestamistas para discutir tu solicitud y responder a cualquier pregunta adicional.\n7. Esperar la aprobación del préstamo y cumplir con cualquier requisito adicional solicitado por el prestamista.\n8. Una vez aprobado, recibir los fondos y comenzar a implementar tu plan de expansión."},
    {"role": "assistant", "content": "Para financiar la expansión de tu pequeña empresa, hay varias opciones disponibles:\n\n### Opciones de Financiamiento para Pequeñas Empresas\n1. Préstamos bancarios tradicionales.\n2. Líneas de crédito.\n3. Préstamos de la Administración de Pequeñas Empresas (SBA).\n4. Financiamiento de equipos.\n5. Factoring de cuentas por cobrar.\n6. Inversores ángeles.\n7. Capital de riesgo.\n8. Crowdfunding.\n9. Subvenciones y ayudas gubernamentales.\n\n### Pasos para Solicitar un Préstamo para Expandir tu Negocio\n1. Evaluar tus necesidades financieras y determinar el monto del préstamo necesario.\n2. Preparar un plan de negocios detallado que explique cómo se utilizarán los fondos y cómo se espera que el negocio crezca.\n3. Reunir la documentación financiera necesaria, incluyendo estados financieros, declaraciones de impuestos y proyecciones financieras.\n4. Investigar y comparar diferentes opciones de préstamo para encontrar la que mejor se adapte a tus necesidades.\n5. Completar y enviar la solicitud de préstamo, incluyendo toda la documentación requerida.\n6. Asistir a entrevistas o reuniones con los prestamistas para discutir tu solicitud y responder a cualquier pregunta adicional.\n7. Esperar la aprobación del préstamo y cumplir con cualquier requisito adicional solicitado por el prestamista.\n8. Una vez aprobado, recibir los fondos y comenzar a implementar tu plan de expansión."},
    # example 10
    {"role": "user", "content": "¿Cuáles son los requisitos para adoptar un perro de un refugio y qué pasos debo seguir para completar el proceso?"},
    {"role": "assistant", "content": None, "function_call": None, "tool_calls": [
        {"id": "call_31", "function": {"arguments": "{\"query\":\"¿Cuáles son los requisitos para adoptar un perro de un refugio?\"}", "name": "doc_retrievalaugmented"}, "type": "function"},
        {"id": "call_32", "function": {"arguments": "{\"query\":\"¿Qué pasos debo seguir para completar el proceso de adopción de un perro en un refugio?\"}", "name": "doc_retrievalaugmented"}, "type": "function"}
    ]},
    {"tool_call_id": "call_31", "role": "tool", "name": "doc_retrievalaugmented", "content": "Requisitos para Adoptar un Perro de un Refugio\n# Requisitos\n1. Ser mayor de 18 años.\n2. Presentar identificación válida con foto.\n3. Proveer prueba de domicilio.\n4. Completar un formulario de adopción.\n5. Realizar una entrevista con el personal del refugio.\n6. Pagar una tarifa de adopción.\n7. Aceptar una visita de seguimiento para asegurar el bienestar del perro.\n\n\n####################################################################################################\n\n\n"},
    {"tool_call_id": "call_32", "role": "tool", "name": "doc_retrievalaugmented", "content": "Pasos para Completar el Proceso de Adopción de un Perro en un Refugio\n# Pasos\n1. Visitar el refugio y elegir un perro que te interese.\n2. Completar el formulario de adopción y presentar la documentación requerida.\n3. Asistir a la entrevista de adopción con el personal del refugio.\n4. Pagar la tarifa de adopción y recibir información sobre el cuidado del perro.\n5. Organizar y aceptar la visita de seguimiento post-adopción.\n6. Llevar al perro a su nuevo hogar y comenzar el proceso de adaptación."},
    {"role": "assistant", "content": "Para adoptar un perro de un refugio, debes cumplir con los siguientes requisitos:\n\n### Requisitos para Adoptar un Perro de un Refugio\n1. Ser mayor de 18 años.\n2. Presentar identificación válida con foto.\n3. Proveer prueba de domicilio.\n4. Completar un formulario de adopción.\n5. Realizar una entrevista con el personal del refugio.\n6. Pagar una tarifa de adopción.\n7. Aceptar una visita de seguimiento para asegurar el bienestar del perro.\n\n### Pasos para Completar el Proceso de Adopción\n1. Visitar el refugio y elegir un perro que te interese.\n2. Completar el formulario de adopción y presentar la documentación requerida.\n3. Asistir a la entrevista de adopción con el personal del refugio.\n4. Pagar la tarifa de adopción y recibir información sobre el cuidado del perro.\n5. Organizar y aceptar la visita de seguimiento post-adopción.\n6. Llevar al perro a su nuevo hogar y comenzar el proceso de adaptación."}
]


############################### Open AI Client ###############################
client = AzureOpenAI(
    azure_endpoint=os.getenv("OPENAI_API_BASE_2"),
    api_key=os.getenv("OPENAI_API_KEY_2"),
    api_version=os.getenv("OPENAI_API_VERSION_2")
)

############################### Define Agent ###############################
class Agent:
    def __init__(self, conversation_history_few_shots, tools, available_tools, gpt_model):
        self.conversation_history = conversation_history_few_shots.copy()
        self.tools = tools
        self.gpt_model = gpt_model
        self.available_tools = available_tools

    def add_message(self, role, content):
        message = {"role": role, "content": content}
        self.conversation_history.append(message)

    def display_conversation(self):
        role_to_color = {
            "system": "red",
            "user": "green",
            "assistant": "blue",
            "tool": "magenta",
        }
        for message in self.conversation_history:
            print(
                colored(
                    f"{message['role']}: {message['content']}\n\n",
                    role_to_color[message["role"]],
                )
            )

    def get_interactions_array(self):
        interactions = []

        passed_system_message = False
        interaction_start = False
        interaction = {}
        tool_responses = []

        for message in self.conversation_history:
            if message["role"] == "system":
                passed_system_message = True
            elif passed_system_message and message["role"] == "user":
                interaction_start = True
                interaction["query"] = message["content"]
            elif passed_system_message and message["role"] == "assistant" and message["content"] == None and interaction_start and "tool_calls" in message:
                tool_calls_output = ""
                for tool_call in message["tool_calls"]:
                    tool_calls_output += f"Tool Call ID: {tool_call['id']}\nTool Name: {tool_call['function']['name']}\nTool Arguments: {tool_call['function']['arguments']}\n\n"
                interaction["assistant_tool_calls_length"] = len(message["tool_calls"])
                interaction["assistant_tool_calls"] = tool_calls_output
            elif passed_system_message and message["role"] == "tool" and interaction_start:
                tool_responses.append("*"*160 + "\n" + "*"*70 + message["tool_call_id"] + "*"*70 + "\n" + "*"*160 + "\n" + message["content"])
            elif passed_system_message and message["role"] == "assistant" and message["content"] != None and interaction_start:
                interaction["tool_responses"] = "\n\n\n\n".join(tool_responses)
                interaction["assistant_response"] = message["content"]
                interactions.append(interaction)
                interaction_start = False
                interaction = {}
                tool_responses = []
            elif passed_system_message:
                print("ERROR ::: EXPORTANDO LAS INTERACCIONES ESTE MENSAJE NO ENTRO A NINGUNA CONDICIÓN :::: \n", message)
        
        return interactions

    @retry(wait=wait_random_exponential(min=1, max=40), stop=stop_after_attempt(3))
    def chat_completion_request(self):
        try:
            response = client.chat.completions.create(
                model=self.gpt_model,
                messages=self.conversation_history,
                tools=self.tools,
                tool_choice="auto",  # auto is default, but we'll be explicit, can be required if it must call one or more tools vía {"type": "function", "function": {"name": "my_function"}}, None if no calls are needed
            )
            return response
        except Exception as e:
            print("Unable to generate ChatCompletion response")
            print(f"Exception: {e}")
            return e

    def chat_completion_with_tool_execution(self):
        """This function makes a ChatCompletion API call with the option of adding tools"""
        
        response = self.chat_completion_request()
        print("FIRST ASSISTANT chat_completion_with_tool_execution RESPONSE :::  \n", response)
        print()
        response_message = response.choices[0].message.dict()
        self.conversation_history.append(response_message)
        tool_calls = response.choices[0].message.tool_calls
        
        if tool_calls:
            for tool_call in tool_calls:
                function_name = tool_call.function.name
                function_to_call = available_tools[function_name]
                function_args = json.loads(tool_call.function.arguments)
                
                print("TOOL REQUESTED, CALLING FUNCTION: "+ str(function_name))
                function_response = function_to_call(
                    query=function_args.get("query")
                )
                print()
                
                self.conversation_history.append(
                    {
                        "tool_call_id": tool_call.id,
                        "role": "tool",
                        "name": function_name,
                        "content": function_response,
                    }
                )  # extend conversation with function response
                
            response = self.chat_completion_request()
        else:
            print("FUNCTION NOT REQUIRED, RESPONDING TO USER")
            
        return response
    
    def answer(self, query):
        print("USER QUERY ::: \n", query)
        print()
        self.add_message("user", query)
        chat_response = self.chat_completion_with_tool_execution()
        assistant_message = chat_response.choices[0].message.content
        print("FINAL ASSISTANT chat_completion_with_tool_execution RESPONSE :::  \n", assistant_message)
        self.add_message("assistant", assistant_message)
        return assistant_message

############################### Define model and tools ###############################

GPT_MODEL = "gpt-4o-cde-aia"
EMBEDDING_MODEL = "text-embedding-ada-002-cde-aia"

rag_tools = [
    {
        "type": "function",
        "function": {
            "name": "doc_retrievalaugmented",
            "description": """Usa esta función para recuperar información útil para responder a la pregunta o consulta del usuario. Recuerda que entre más simple y concisa sea la consulta, mejores resultados tendrás en los resultados de información recuperada. Si el query es muy complejo, considera dividirlo en partes más simples y realizar consultas separadas.""",
            "parameters": {
                "type": "object",
                "properties": {
                    "query": {
                        "type": "string",
                        "description": "Descripción de la información necesaria para responder a una pregunta en texto basada en la pregunta o consulta del usuario. Si la pregunta o consulta del usuario requiere de dos o más conceptos de información, esta entrada debe ser una descomposición de la pregunta original del usuario centrada en una pieza específica de información."
                    }
                },
            "required": ["query"]
            }
        }
    }
]

def rag(query):
    retriever = Retriever(k=5) 
    docs = retriever.retrieve(query=query)
    return docs.get_texts_as_str(token=f"\n\n\n{100*'#'}\n")

available_tools = {
            "doc_retrievalaugmented": rag
        }

############################### Process evaluation dataset questions ###############################

preguntas = pd.read_excel("Preguntas_Creditos.xlsx")['Pregunta'].tolist()

all_interactions = []

for pregunta in preguntas:
    agente = Agent(conversation_history_few_shots=conversation_history_few_shot, tools=rag_tools, available_tools=available_tools, gpt_model=GPT_MODEL)
    agente.add_message(
        "system", 
        """"Eres un asistente eficiente que recupera documentación para responder a las preguntas de los usuarios. 
        Utiliza la herramienta proporcionada para obtener la información necesaria. 
        Si la pregunta del usuario es compleja, requiere comparación, diferencias o múltiples fuentes de información, no pases el query directamente al tool. 
        En su lugar, divídela en consultas más específicas sobre la información antes de usar la herramienta e interpreta tu las diferencias, comparaciones y razonamientos. 
        Cada consulta debe ser clara y concisa."""
    )
    answer = agente.answer(pregunta)
    print("*"*100)
    print()
    print()

    interactions = agente.get_interactions_array()
    all_interactions.extend(interactions)

df = pd.DataFrame(all_interactions)
df.to_excel("output.xlsx")

# TODO:
# - Unificar todo en una clase de tal manera que podamos instanciar una clase Agente, le pasemos un query a .answer y el devuelva la respuesta. Y el log o algo. --> OK
# - Refinar few shots / system / descripción tool y parametros para tratar de que si parta las cosas como queremos. --> OK
# - Pruebas. --> OK
# - Poner las respuestas en el excel o algo para evaluar. --> OK.
# - Organizar salida para que sea más legible. --> OK.
# - Probar con las preguntas multi hub de Leo. --> OK
# - Deberíamos procesar cada pregunta con el conversation_history vacío cierto? pues o sólo con los few shots, no todas las preguntas concatenadas? --> OK, si es así.
# - Qué más?..... Esperemos a ver como nos va... mientras tanto de pronto meter más preguntas que no sean tan SI o NO, sino más abiertas (meter unas 2 o 3)
# - Evaluación de los resultados teniendo en cuenta que muchas preguntas son SI o NO o un dato, hacemos que el system responda así? o cómo? --> Evaluarlo de forma que interpretemos lo que dijo como SI, NO o el Dato que necesitamos.
# - Si los resultados no son los mejores refinar más prompts.
